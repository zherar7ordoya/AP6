

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >

<!-- Mirrored from mvcsharp.org/Advanced_Customization/Default.aspx by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 30 Oct 2008 03:47:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head><title>
	Advanced Customization
</title><link href="../Styles.css" rel="stylesheet" type="text/css" /></head>
<body>
    <form name="aspnetForm" method="post" action="http://mvcsharp.org/Advanced_Customization/Default.aspx" id="aspnetForm">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTEwMDUyNjYzMjgPZBYCZg9kFgICAw9kFgICCQ88KwAJAgAPFgQeDU5ldmVyRXhwYW5kZWRkHgtfIURhdGFCb3VuZGdkCBQrAAUFDzA6MCwwOjEsMDoyLDA6MxQrAAIWDB4EVGV4dAUNRG9jdW1lbnRhdGlvbh4FVmFsdWUFDURvY3VtZW50YXRpb24eC05hdmlnYXRlVXJsBRMvRG9jdW1lbnRhdGlvbi5hc3B4HghEYXRhUGF0aAUTL2RvY3VtZW50YXRpb24uYXNweB4JRGF0YUJvdW5kZx4IRXhwYW5kZWRnFCsABQUPMDowLDA6MSwwOjIsMDozFCsAAhYKHwIFCE92ZXJ2aWV3HwMFCE92ZXJ2aWV3HwQFFi9PdmVydmlldy9EZWZhdWx0LmFzcHgfBQUWL292ZXJ2aWV3L2RlZmF1bHQuYXNweB8GZ2QUKwACFgwfAgUIRXhhbXBsZXMfAwUIRXhhbXBsZXMfBAUOL0V4YW1wbGVzLmFzcHgfBQUOL2V4YW1wbGVzLmFzcHgfBmcfB2cUKwAHBRcwOjAsMDoxLDA6MiwwOjMsMDo0LDA6NRQrAAIWCh8CBRwxLiBHZXR0aW5nIHN0YXJ0ZWQgd2l0aCBNVkMjHwMFHDEuIEdldHRpbmcgc3RhcnRlZCB3aXRoIE1WQyMfBAUrL0dldHRpbmdfc3RhcnRlZF93aXRoX01WQ1NoYXJwL0RlZmF1bHQuYXNweB8FBSsvZ2V0dGluZ19zdGFydGVkX3dpdGhfbXZjc2hhcnAvZGVmYXVsdC5hc3B4HwZnZBQrAAIWCh8CBRQyLiBUYXNrcyBpbnRlcmFjdGlvbh8DBRQyLiBUYXNrcyBpbnRlcmFjdGlvbh8EBR8vVGFza3NfSW50ZXJhY3Rpb24vRGVmYXVsdC5hc3B4HwUFHy90YXNrc19pbnRlcmFjdGlvbi9kZWZhdWx0LmFzcHgfBmdkFCsAAhYKHwIFHjMuIFVzaW5nIFdpbmZvcm1zIHZpZXdzIGVuZ2luZR8DBR4zLiBVc2luZyBXaW5mb3JtcyB2aWV3cyBlbmdpbmUfBAUpL1VzaW5nX1dpbmZvcm1zX3ZpZXdzX2VuZ2luZS9EZWZhdWx0LmFzcHgfBQUpL3VzaW5nX3dpbmZvcm1zX3ZpZXdzX2VuZ2luZS9kZWZhdWx0LmFzcHgfBmdkFCsAAhYKHwIFKDQuIFJld29ya2luZyBBU1AuTkVUIE1WQyBTdG9yZSB3aXRoIE1WQyMfAwUoNC4gUmV3b3JraW5nIEFTUC5ORVQgTVZDIFN0b3JlIHdpdGggTVZDIx8EBSgvUmV3b3JraW5nX0FTUE5FVF9NVkNfU3RvcmUvRGVmYXVsdC5hc3B4HwUFKC9yZXdvcmtpbmdfYXNwbmV0X212Y19zdG9yZS9kZWZhdWx0LmFzcHgfBmdkFCsAAhYOHwIFGTUuIEFkdmFuY2VkIEN1c3RvbWl6YXRpb24fAwUZNS4gQWR2YW5jZWQgQ3VzdG9taXphdGlvbh8EBSQvQWR2YW5jZWRfQ3VzdG9taXphdGlvbi9EZWZhdWx0LmFzcHgfBQUkL2FkdmFuY2VkX2N1c3RvbWl6YXRpb24vZGVmYXVsdC5hc3B4HwZnHghTZWxlY3RlZGcfB2dkFCsAAhYKHwIFGjYuIFNpbHZlcmxpZ2h0IGFuZCAuTkVUIENGHwMFGjYuIFNpbHZlcmxpZ2h0IGFuZCAuTkVUIENGHwQFES9TaWx2ZXJsaWdodC5hc3B4HwUFES9zaWx2ZXJsaWdodC5hc3B4HwZnZBQrAAIWCh8CBQhBUEkgRG9jcx8DBQhBUEkgRG9jcx8EBRQvQVBJX0RvY3MvSW5kZXguYXNweB8FBRQvYXBpX2RvY3MvaW5kZXguYXNweB8GZ2QUKwACFgofAgULRGV2ZWxvcG1lbnQfAwULRGV2ZWxvcG1lbnQfBAURL0RldmVsb3BtZW50LmFzcHgfBQURL2RldmVsb3BtZW50LmFzcHgfBmcUKwAFBQ8wOjAsMDoxLDA6MiwwOjMUKwACFgofAgUYMS4gQmFzaWNzIG9mIE1WQyBhbmQgTVZQHwMFGDEuIEJhc2ljcyBvZiBNVkMgYW5kIE1WUB8EBSMvQmFzaWNzX29mX01WQ19hbmRfTVZQL0RlZmF1bHQuYXNweB8FBSMvYmFzaWNzX29mX212Y19hbmRfbXZwL2RlZmF1bHQuYXNweB8GZ2QUKwACFgofAgUmMi4gSW1wbGVtZW50aW5nIGNvcmUgTVZQIGZ1bmN0aW9uYWxpdHkfAwUmMi4gSW1wbGVtZW50aW5nIGNvcmUgTVZQIGZ1bmN0aW9uYWxpdHkfBAUxL0ltcGxlbWVudGluZ19jb3JlX01WUF9mdW5jdGlvbmFsaXR5L0RlZmF1bHQuYXNweB8FBTEvaW1wbGVtZW50aW5nX2NvcmVfbXZwX2Z1bmN0aW9uYWxpdHkvZGVmYXVsdC5hc3B4HwZnZBQrAAIWCh8CBSIzLiBEZXNpZ25pbmcgV2luZm9ybXMgdmlld3MgZW5naW5lHwMFIjMuIERlc2lnbmluZyBXaW5mb3JtcyB2aWV3cyBlbmdpbmUfBAUtL0Rlc2lnbmluZ19XaW5mb3Jtc192aWV3c19lbmdpbmUvRGVmYXVsdC5hc3B4HwUFLS9kZXNpZ25pbmdfd2luZm9ybXNfdmlld3NfZW5naW5lL2RlZmF1bHQuYXNweB8GZ2QUKwACFgofAgUeNC4gU3Ryb25nbHkgdHlwZWQgYXNzb2NpYXRpb25zHwMFHjQuIFN0cm9uZ2x5IHR5cGVkIGFzc29jaWF0aW9ucx8EBSkvU3Ryb25nbHktdHlwZWRfYXNzb2NpYXRpb25zL0RlZmF1bHQuYXNweB8FBSkvc3Ryb25nbHktdHlwZWRfYXNzb2NpYXRpb25zL2RlZmF1bHQuYXNweB8GZ2QUKwACFgofAgUHQ2hhbmdlcx8DBQdDaGFuZ2VzHwQFDS9DaGFuZ2VzLmFzcHgfBQUNL2NoYW5nZXMuYXNweB8GZ2QUKwACFgofAgUIRmVlZGJhY2sfAwUIRmVlZGJhY2sfBAUOL0ZlZWRiYWNrLmFzcHgfBQUOL2ZlZWRiYWNrLmFzcHgfBmdkFCsAAhYKHwIFCERvd25sb2FkHwMFCERvd25sb2FkHwQFDi9Eb3dubG9hZC5hc3B4HwUFDi9kb3dubG9hZC5hc3B4HwZnZGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFCmN0bDAwJE1lbnX4QwVmR4pzH3iLK78Xm6b0E04W8g==" />

        <div id="pageWrapper">
            
            <div>
                <img id="ctl00_logo" src="../Images/logo.PNG" border="0" />
                <div id="breadcrumbs">
                    <div><img id="ctl00_spacer" src="../Images/spacer.bmp" height="1" width="875" border="0" /></div>
                    <span id="ctl00_SiteMapPath"><a href="#ctl00_SiteMapPath_SkipLink"><img alt="Skip Navigation Links" height="0" width="0" src="../WebResourcee862.gif?d=-tf2UOPilGOzHQ2P_iOPlg2&amp;t=633440833918844552" border="0" /></a><span><a href="../Default.html">Home</a></span><span>&#160;&gt;&#160;</span><span><a href="../Documentation.html">Documentation</a></span><span>&#160;&gt;&#160;</span><span><a href="../Examples.html">Examples</a></span><span>&#160;&gt;&#160;</span><span>5. Advanced Customization</span><a id="ctl00_SiteMapPath_SkipLink"></a></span>
                </div>
            </div>
            <div id="menuAndContent">
                <div id="menu">
                    <a href="#ctl00_Menu_SkipLink"><img alt="Skip Navigation Links." src="../WebResourcee862.gif?d=-tf2UOPilGOzHQ2P_iOPlg2&amp;t=633440833918844552" width="0" height="0" border="0" /></a><table id="ctl00_Menu" cellpadding="0" cellspacing="0" border="0" width="238"><tr><td>
	<table cellpadding="0" cellspacing="0">
		<tr>
			<td class="menuItem"><a class="menuItem" href="../Documentation.html" id="ctl00_Menun0">Documentation</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Overview/Default.html" id="ctl00_Menun1">Overview</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Examples.html" id="ctl00_Menun2">Examples</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Getting_started_with_MVCSharp/Default.html" id="ctl00_Menun3">1. Getting started with MVC#</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Tasks_Interaction/Default.html" id="ctl00_Menun4">2. Tasks interaction</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Using_Winforms_views_engine/Default.html" id="ctl00_Menun5">3. Using Winforms views engine</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Reworking_ASPNET_MVC_Store/Default.html" id="ctl00_Menun6">4. Reworking ASP.NET MVC Store with MVC#</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItemSelected menuItem"><a class="menuItemSelected menuItem" href="Default.html" id="ctl00_Menun7">5. Advanced Customization</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Silverlight.html" id="ctl00_Menun8">6. Silverlight and .NET CF</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="http://mvcsharp.org/API_Docs/Index.aspx" id="ctl00_Menun9">API Docs</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td><table width="20">
				<tr>
					<td></td>
				</tr>
			</table></td><td class="menuItem"><a class="menuItem" href="../Development.html" id="ctl00_Menun10">Development</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td class="menuItem"><a class="menuItem" href="../Changes.html" id="ctl00_Menun15">Changes</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td class="menuItem"><a class="menuItem" href="../Feedback.html" id="ctl00_Menun16">Feedback</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0">
		<tr>
			<td class="menuItem"><a class="menuItem" href="../Download.html" id="ctl00_Menun17">Download</a></td>
		</tr>
	</table>
</td></tr></table><a id="ctl00_Menu_SkipLink"></a>
                </div> 
                <div id="content">  
                    
    <h1>
       MVC# Advanced Customization (Office 2007 UI and more)</h1>
    <p>
        <em>The source code of this example can be found under "Examples\Advanced (Office2007 UI and more)\"
            subfolder of the MVC# root folder. The framework itself can be downloaded from <a
                href="http://www.mvcsharp.org/Download.aspx">www.MVCSharp.org/download.aspx</a>.</em></p>
    <p>
        <a href="#Introduction">Introduction</a><br />
        <a href="#Using 3rd-party components (Office 2007-like UI)">Using 3rd-party components (Office 2007-like UI)</a><br />
        <a href="#Outlook-like navigation">Outlook-like navigation</a><br />
        <a href="#Extended view and interaction point definitions">Extended view and interaction point definitions</a><br />
        <a href="#Views in multiple assemblies">Views in multiple assemblies</a><br />
        <a href="#Customized Controller creation">Customized Controller creation</a><br />
        <a href="#Adding views dynamically">Adding views dynamically</a><br />
        <a href="#Summary">Summary</a><br /></p>
    <a id="Introduction"></a><h2>
    Introduction</h2>
    <p>
        In the earlier articles (<a href="../Getting_started_with_MVCSharp/Default.html">here</a>
        and <a href="../Tasks_Interaction/Default.html">here</a> - read them prior to proceeding)
        we have got acquainted with MVC# - a framework for simplifying the usage of the
        Model-View-Presenter pattern in .NET applications. We have covered all basic requirements
        and scenarios of using the MVP architectural pattern. However in the real-world
        conditions application's requirements diverge from those basic ones. Complex applications
        often demand for an advanced customization and fine-tuning. And, of course, robust
        frameworks should cope well with such specific requirements.</p>
    <p>
        This article steeps deeper into the MVC# framework capabilities demonstrating its
        advanced usage scenarios. These scenarios range from extending view and task descriptions
        to customizing navigation and presentation styles. Each advanced feature is covered
        in a separate article section and may be read independently.</p>
    <a id="Using 3rd-party components (Office 2007-like UI)"></a><h2>
        Using 3rd-party components (Office 2007-like UI)</h2>
    <p>
        The major drawback of many existing MVC/MVP frameworks is that they require certain
        UI components to be used with them. For example the ASP.NET MVC framework comes
        with its own set of UI elements, CAB (Composite UI Application Block) is either
        not compatible with many 3rd-party components. With such frameworks a developer
        finds himself restricted in choosing the UI components he likes. MVC#, on the other
        hand, does not impose any limitations of such kind. Developers may use MVC# with
        any 3rd-party library they are committed to. In this article we are using MVC# with
        3rd-party UI components for creating Office 2007-like user interface.</p>
    <p>
        The main form of our application will be constituted of menu with toolbar strips,
        an Outlook-like navigation pane on the left and an Outlook-like content panel on
        the right (see the picture below). To apply the Outlook 2007 style to the menu and
        toolbar strips we will use an open-source 3rd-party renderer component by <a href="http://www.componentfactory.com/">
            ComponentFactory</a> (downloadable from <a href="http://www.codeproject.com/KB/menus/Office2007Renderer.aspx">
                here</a>). The Outlook-like navigation pane we will use is the open-source
        component by Muhammed Şahin (get it <a href="http://www.codeproject.com/KB/office/Outlook_Navigation_Pane.aspx">
            here</a>). And the Outlook-like content pane is the slightly modified Outlook-style
        panel from <a href="http://www.openwinforms.com/">http://www.openwinforms.com</a>.</p>
    <p><img alt="Office 2007 3rd-party components" src="Images/1.png"/></p>
    <p>
        By now we should have only placed the said 3rd-party controls on the form and set
        their basic properties. Later on we will handle events from these controls and make
        them interact with the framework.</p>
    <a id="Outlook-like navigation"></a><h2>
        Outlook-like navigation</h2>
    <p>
        When a user selects an item in the navigation pane an appropriate view should be
        shown in the content pane on the right. In MVC# the way of switching between views
        is defined by the views manager class. Therefore the desired kind of navigation can be implemented
        by writing a custom <code>WinformsViewsManager</code> subclass - <code>OutlookLikeViewsManager</code>.</p>
    <p>
        Firstly,
        this new views manager should gain access to the content panel of the main form:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> OutlookLikeViewsManager : WinformsViewsManager
    ...
        </span><span style="color: #0000FF;">protected</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> InitializeFormView(Form form,
                                                   WinformsViewInfo viewInf)
        {
            </span><span style="color: #0000FF;">base</span><span style="color: #000000;">.InitializeFormView(form, viewInf);
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> If it's main form then access its content panel.</span><span style="color: #008000;">
</span><span style="color: #000000;">            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (form </span><span style="color: #0000FF;">is</span><span style="color: #000000;"> MainForm)
                contentPanel </span><span style="color: #000000;">=</span><span style="color: #000000;"> form.Controls[</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">contentPanel</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">] </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> OutlookPanelEx;
        }</span></pre>
    <p>
        If a newly created view does not have a parent container then it should be placed
        inside the content panel:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> OutlookLikeViewsManager : WinformsViewsManager
    ...
        </span><span style="color: #0000FF;">protected</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> InitializeUserControlView(UserControl ucView)
        {
            </span><span style="color: #0000FF;">base</span><span style="color: #000000;">.InitializeUserControlView(ucView);
            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (ucView.Parent </span><span style="color: #000000;">!=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">null</span><span style="color: #000000;">) </span><span style="color: #0000FF;">return</span><span style="color: #000000;">;

            ucView.Parent </span><span style="color: #000000;">=</span><span style="color: #000000;"> contentPanel;
            ucView.Dock </span><span style="color: #000000;">=</span><span style="color: #000000;"> DockStyle.Fill;
        }</span></pre>
    <p>
        Whenever a view is activated it should be placed on top over other views:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> OutlookLikeViewsManager : WinformsViewsManager
    ...
        </span><span style="color: #0000FF;">protected</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> ActivateUserControlView(IView view)
        {
            </span><span style="color: #0000FF;">base</span><span style="color: #000000;">.ActivateUserControlView(view);
            (view </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> UserControl).BringToFront();
        }</span></pre>
    <p>
        Finally, in the Main form code we should handle the selection of an item inside
        the navigation bar:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">partial</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainForm ...
    ...
        </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> navBarListView_ItemActivate(</span><span style="color: #0000FF;">object</span><span style="color: #000000;"> sender, EventArgs e)
        {
            Controller.NavigateToView((sender </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> ListView).FocusedItem.Text);
        }</span></pre>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainViewController : ControllerBase
    ...
        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> NavigateToView(</span><span style="color: #0000FF;">string</span><span style="color: #000000;"> viewName)
        {
            Task.Navigator.Navigate(viewName);
        }</span></pre>
    <a id="Extended view and interaction point definitions"></a><h2>
        Extended view and interaction point definitions</h2>
    <p>
        The conventional way for describing View-Controller pairs is using <code>[IPoint]</code> attributes
        inside the task declaration. Since views in our application are divided
        into three categories (Mail, Notes, Tasks) we might want to supplement the <code>[IPoint]</code> attribute with additional category information.
        So we will introduce the <code>[IPointEx]</code> attribute and the <code>InteractionPointInfoEx</code> class:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> IPointExAttribute : IPointAttribute
    {
        </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> ViewCategory viewCat;

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> IPointExAttribute(ViewCategory viewCat, Type controllerType,
                                                       </span><span style="color: #0000FF;">bool</span><span style="color: #000000;"> isCommonTarget)
                                    : </span><span style="color: #0000FF;">base</span><span style="color: #000000;">(controllerType, isCommonTarget)
        {
            </span><span style="color: #0000FF;">this</span><span style="color: #000000;">.viewCat </span><span style="color: #000000;">=</span><span style="color: #000000;"> viewCat;
        }

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> ViewCategory ViewCategory
        {
            </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> { </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> viewCat; }
            </span><span style="color: #0000FF;">set</span><span style="color: #000000;"> { viewCat </span><span style="color: #000000;">=</span><span style="color: #000000;"> value; }
        }
    }</span></pre>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> InteractionPointInfoEx : InteractionPointInfo
    {
        </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> ViewCategory viewCat;

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> ViewCategory ViewCategory
        {
            </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> { </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> viewCat; }
            </span><span style="color: #0000FF;">set</span><span style="color: #000000;"> { viewCat </span><span style="color: #000000;">=</span><span style="color: #000000;"> value; }
        }
    }</span></pre>
    <p>
        For the new <code>[IPointEx]</code> attributes to be properly processed a custom
        <code>TaskInfoByAttributesProvider</code> descendant is required:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> TaskInfoByAttributesProviderEx : TaskInfoByAttributesProvider
    ...
        </span><span style="color: #0000FF;">protected</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> InteractionPointInfo CreateInteractionPointInfo(
                           </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> viewName, InteractionPointAttribute ipAttribute)
        {
            InteractionPointInfoEx result </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> InteractionPointInfoEx();
            result.ViewName </span><span style="color: #000000;">=</span><span style="color: #000000;"> viewName;
            result.ControllerType </span><span style="color: #000000;">=</span><span style="color: #000000;"> ipAttribute.ControllerType;
            result.IsCommonTarget </span><span style="color: #000000;">=</span><span style="color: #000000;"> ipAttribute.IsCommonTarget;
            result.ViewCategory </span><span style="color: #000000;">=</span><span style="color: #000000;"> (ipAttribute </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> IPointExAttribute).ViewCategory;
            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> result;
        }</span></pre>
    <p>
        The similar technique is applied when extending view definitions. Say, we want to
        associate each view with the corresponding image name. Then we should introduce
        the <code>[ViewEx]</code> attribute and the <code>ViewInfoEx</code> class:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> ViewExAttribute : ViewAttribute
    {
        </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> imgName;

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> ViewExAttribute(Type taskType, </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> viewName, </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> imgName)
            : </span><span style="color: #0000FF;">base</span><span style="color: #000000;">(taskType, viewName)
        {
            </span><span style="color: #0000FF;">this</span><span style="color: #000000;">.imgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> imgName;
        }

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> ImgName
        {
            </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> { </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> imgName; }
            </span><span style="color: #0000FF;">set</span><span style="color: #000000;"> { imgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> value; }
        }
    }</span></pre>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> ViewInfoEx : ViewInfo
    {
        </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> imgName;

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> ViewInfoEx(</span><span style="color: #0000FF;">string</span><span style="color: #000000;"> viewName, </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> imgName, Type viewType)
            : </span><span style="color: #0000FF;">base</span><span style="color: #000000;">(viewName, viewType)
        {
            </span><span style="color: #0000FF;">this</span><span style="color: #000000;">.imgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> imgName;
        }

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> ImgName
        {
            </span><span style="color: #0000FF;">get</span><span style="color: #000000;"> { </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> imgName; }
            </span><span style="color: #0000FF;">set</span><span style="color: #000000;"> { imgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> value; }
        }
    }</span></pre>
    <p>
        In order to interpret <span style="font-family: Courier New">[ViewEx]</span> attributes
        we also need to create a <code>DefaultViewInfosProvider</code> descendant:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> ViewInfosPrividerEx : DefaultViewInfosProvider
    {
        </span><span style="color: #0000FF;">protected</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> ViewInfo newViewInfo(Type viewType, ViewAttribute vAtr)
        {
            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> ViewInfoEx(vAtr.ViewName,
                  (vAtr </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> ViewExAttribute).ImgName, viewType);
        }
    }</span></pre>
    <p>
        Before staring the main task the framework should be configured to use the above
        <code>TaskInfoByAttributesProviderEx</code> and <code>ViewInfosPrividerEx</code> classes:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Program
    {
        [STAThread]
        </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> Main()
        {
            MVCConfiguration cfg </span><span style="color: #000000;">=</span><span style="color: #000000;"> OutlookLikeViewsManager.GetDefaultConfig();
            cfg.TaskInfoProviderType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(TaskInfoByAttributesProviderEx);
            cfg.ViewInfosProviderType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(ViewInfosPrividerEx);
            (</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> TasksManager(cfg)).StartTask(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(MainTask));
            Application.Run(Application.OpenForms[</span><span style="color: #800080;">0</span><span style="color: #000000;">]);
        }
    }</span></pre>
    <p>
        Finally, view navigation links inside the navigation pane should be added with properly
        set category and image:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">partial</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainForm ...
    ...
        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> Initialize()
        {
            TaskInfo ti </span><span style="color: #000000;">=</span><span style="color: #000000;"> Controller.Task.Navigator.TaskInfo;
            </span><span style="color: #0000FF;">foreach</span><span style="color: #000000;"> (InteractionPointInfoEx ip </span><span style="color: #0000FF;">in</span><span style="color: #000000;"> ti.InteractionPoints)
                AddViewToNavPane(ip);
        }

        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> AddViewToNavPane(InteractionPointInfoEx ip)
        {
            TaskInfo ti </span><span style="color: #000000;">=</span><span style="color: #000000;"> Controller.Task.Navigator.TaskInfo;
            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (ip.ViewCategory </span><span style="color: #000000;">==</span><span style="color: #000000;"> ViewCategory.None) </span><span style="color: #0000FF;">return</span><span style="color: #000000;">;
            ViewInfoEx vi </span><span style="color: #000000;">=</span><span style="color: #000000;"> ti.ViewInfos[ip.ViewName] </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> ViewInfoEx;
            Image i </span><span style="color: #000000;">=</span><span style="color: #000000;"> Resources.ResourceManager.GetObject(vi.ImgName) </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> Image;
            imgList.Images.Add(ip.ViewName, i);
            ListView lv </span><span style="color: #000000;">=</span><span style="color: #000000;"> lvMail;
            </span><span style="color: #0000FF;">switch</span><span style="color: #000000;"> (ip.ViewCategory)
            {
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Mail: lv </span><span style="color: #000000;">=</span><span style="color: #000000;"> lvMail; </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Notes: lv </span><span style="color: #000000;">=</span><span style="color: #000000;"> lvNotes; </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Tasks: lv </span><span style="color: #000000;">=</span><span style="color: #000000;"> lvTasks; </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
            }
            lv.Items.Add(ip.ViewName, ip.ViewName);
        }</span></pre>
    <a id="Views in multiple assemblies"></a><h2>
        Views in multiple assemblies</h2>
    <p>
        For projects with distinctly separated architecture views may be spread among several
        DLL assemblies. If this is the case those assemblies should be appended to the <code>MVCConfiguration.ViewsAssemblies</code>
        collection:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Program
    ...
        </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> Main()
        {
            MVCConfiguration cfg </span><span style="color: #000000;">=</span><span style="color: #000000;"> OutlookLikeViewsManager.GetDefaultConfig();
            cfg.ViewsAssemblies.Add(Assembly.Load(
                    </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">MVCSharp.Examples.AdvancedCustomization.SeparateViews</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
            ...
        }</span></pre>
    <a id="Customized Controller creation"></a><h2>
        Customized Controller creation</h2>
    <p>
        As a rule
        the controller type is specified in the interaction point description.
        However, instead of such explicit declaration the default controller type could
        be used. Each view category (Mail, Notes, Tasks) could be associated with its default
        controller type. Consider, for instance, the following declaration:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainTask : TaskBase
    ...
        [IPointEx(ViewCategory.Notes)]
        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">const</span><span style="color: #000000;"> </span><span style="color: #0000FF;">string</span><span style="color: #000000;"> PinnedNote </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Pinned Note</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">;</span></pre>
    <p>
        Since the controller type is left unspecified above then the default controller
        for the Notes category should be used - <code>NotesController</code> class.</p>
    <p>
        Such functionality could be implemented by creating a custom <code>Navigator</code> subclass
        with overriden <code>GetController</code> method:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> NavigatorEx : Navigator
    ...
        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">override</span><span style="color: #000000;"> IController GetController(</span><span style="color: #0000FF;">string</span><span style="color: #000000;"> viewName)
        {
            IController result </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">base</span><span style="color: #000000;">.GetController(viewName);
            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (result </span><span style="color: #000000;">!=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">null</span><span style="color: #000000;">) </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> result;

            InteractionPointInfoEx ip </span><span style="color: #000000;">=</span><span style="color: #000000;"> TaskInfo.InteractionPoints[viewName]
                                                  </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> InteractionPointInfoEx;
            Type cType;
            </span><span style="color: #0000FF;">switch</span><span style="color: #000000;"> (ip.ViewCategory)
            {
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Mail: cType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(MailController); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Notes: cType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(NoteController); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Tasks: cType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(TaskController); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
            }
            ip.ControllerType </span><span style="color: #000000;">=</span><span style="color: #000000;"> cType;
            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">base</span><span style="color: #000000;">.GetController(viewName);            
        }</span></pre>
    <p>
        In the above code an interaction point with unspecified controller type gets associated
        to one of the default controller types (depending on the view category - see the
        <code>switch</code> construct above). And then the controller is created with this
        type.</p>
    <p>
        To employ the new <code>NavigatorEx</code> class it should referenced with the help of the <code>[Task]</code>
        attribute:</p>
    <pre>
<span style="color: #000000;">    [Task(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(NavigatorEx))]
    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainTask : TaskBase
    ...</span></pre>
    <p>
        Another option is applying the custom navigator class globally via the <code>MVCConfiguration.NavigatorType</code>
        property.</p>
    <a id="Adding views dynamically"></a><h2>
        Adding views dynamically</h2>
    <p>
        In our example application a user should be able to add views dynamically by clicking
        the appropriate menu item. Depending on the clicked item views of different categories
        will be created:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">partial</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainForm ...
    ...
        </span><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> newToolStripItem_Click(</span><span style="color: #0000FF;">object</span><span style="color: #000000;"> sender, EventArgs e)
        {
            </span><span style="color: #0000FF;">switch</span><span style="color: #000000;"> ((sender </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> ToolStripItem).Text)
            {
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Mail</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">: Controller.CreateView(ViewCategory.Mail); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Note</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">: Controller.CreateView(ViewCategory.Notes); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Task</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">: Controller.CreateView(ViewCategory.Tasks); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
            }
        }</span></pre>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> MainViewController : ControllerBase
    ...
        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> CreateView(ViewCategory c)
        {
            IViewsManager vm </span><span style="color: #000000;">=</span><span style="color: #000000;"> Task.Navigator.ViewsManager;
            InteractionPointInfoEx ip </span><span style="color: #000000;">=</span><span style="color: #000000;"> (vm </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> IDynamicViewsManager).CreateView(c);
            (View </span><span style="color: #0000FF;">as</span><span style="color: #000000;"> IMainView).AddViewToNavPane(ip);
        }</span></pre>
    <p>
        The actual view creation method will reside in the <code>OutlookLikeViewsManager</code> class
        and will do the following: a) Add a new (properly configured) <code>InteractionPointInfoEx</code>
        instance to the interaction point descriptions collection for the task and b) Add a
        new (also configured) <code>ViewInfoEx</code> to the view descriptions collection for the task:</p>
    <pre>
<span style="color: #000000;">    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> OutlookLikeViewsManager: WinformsViewsManager,IDynamicViewsManager
    ...
        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> InteractionPointInfoEx CreateView(ViewCategory vc)
        {
            InteractionPointInfoEx result </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> InteractionPointInfoEx();
            result.ViewName </span><span style="color: #000000;">=</span><span style="color: #000000;"> vc.ToString() </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> (ViewInfos.Count</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">).ToString();
            result.IsCommonTarget </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">true</span><span style="color: #000000;">;
            result.ViewCategory </span><span style="color: #000000;">=</span><span style="color: #000000;"> vc;
            Navigator.TaskInfo.InteractionPoints[result.ViewName] </span><span style="color: #000000;">=</span><span style="color: #000000;"> result;
            ViewInfoEx vi </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> ViewInfoEx(result.ViewName, </span><span style="color: #800000;">&quot;&quot;</span><span style="color: #000000;">, </span><span style="color: #0000FF;">null</span><span style="color: #000000;">);
            </span><span style="color: #0000FF;">switch</span><span style="color: #000000;"> (vc)
            {
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Mail:
                    vi.ImgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Mail</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">; vi.ViewType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(MailView); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Notes:
                    vi.ImgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Notes</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">; vi.ViewType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(NoteView); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000FF;">case</span><span style="color: #000000;"> ViewCategory.Tasks:
                    vi.ImgName </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Tasks</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">; vi.ViewType </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(TaskView); </span><span style="color: #0000FF;">break</span><span style="color: #000000;">;                    
            }
            ViewInfos.Add(vi);
            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> result;
        }</span></pre>
    <a id="Summary"></a><h2>
        Summary</h2>
    <p>
        Throughout this article we have studied a number of advanced MVC# framework features.
        These features help dealing with complicated application's requirements which often
        appear in real-world projects. With the discussed customization techniques developers
        can fully harness MVC# power to creating complex Model-View-Presenter applications.</p>
    <p>
        <em>The source code of this example can be found under "Examples\Advanced (Office2007 UI and more)\"
            subfolder of the MVC# root folder. The framework itself can be downloaded from <a
                href="http://www.mvcsharp.org/Download.aspx">www.MVCSharp.org/download.aspx</a>.</em></p>        

                </div>
            </div>
        </div>
        <div style="text-align:center; font-size:11px;">Copyright © www.MVCSharp.org</div>
    </form>
</body>

<!-- Mirrored from mvcsharp.org/Advanced_Customization/Default.aspx by HTTrack Website Copier/3.x [XR&CO'2008], Thu, 30 Oct 2008 03:47:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>
